# КАЛЬКУЛЯТОР НА ЯЗЫКЕ GOLANG

Данный калькулятор поможет в простых математических вычислениях с числами

Калькулятор полностью написан на языке Golang в рамках курса "Программирование на Go | 24" от Яндекс.Лицея

---
## Описание

В данном проекте использовался собственный код калькулятора из финального задания Спринта 0. Вполне возможно, и я более чем уверен, что существуют куда более компактные импликации данного кода)) Тем не менее, он был структурирован по файлам и загружен на Github

Для себя я выделил несколько этапов его модернизации:
1. Реализовать http-сервер
2. Проработать все возможные ошибки
3. Сделать логирование для http-сервера
4. Написать тесты как для самого калькулятора, так и для http-сервера
5. Написать качественный README   :)

## Как использовать



## Общая структура файлов

![[Pasted image 20241222122821.png]]

## Логика калькулятора

Все вычисления происходят в файле `pkg/calculation/calculation.go`

Основная функция, из которой вызываются все остальные:
`Calc(expression string) (float64, error)`. В ней обрабатываются ошибки, возникшие внутри остальных функций

После отправки запроса пользователем, входное выражение проверяется внутри функции: `checkString(expression string) error`. Здесь идут проверки с помощью циклов на возможные ошибки ввода (подробнее см. Обработка ошибок)

Затем, происходит разбиение выражения на слайс, где элементами являются строки с числами (или операциями в скобках) с стоящими перед ними знаками. Это происходит в функции: `makeSlice(expression string) []string`. Примеры:

| исходное выражение | полученный слайс     |
| ------------------ | -------------------- |
| `2+2`              | `[+2 +2]`            |
| `2+3*(4+5)`        | `[+2 +3 *(4+5)]`     |
| `2+3*(4+(5+6))`    | `[+2 +3 *(4+(5+6))]` |

Рассмотрим выражение без скобок. Полученный слайс отправляется в функцию `multiplyAndDivision(exp_slice []string) ([]string, error)`. 
В ней слайс перебирается, и происходят вычисления только с теми числами, перед которыми стоит знак умножения или деления. На место этого и предыдущего числа ставится результат операции. К примеру, из `[+2 +3 * 4]` получается `[+2 +12]`

Затем итоговый слайс, где теперь только числа с знаками плюса и минуса, передается в `additionAndSubtraction(exp_slice []string) float64`.
Здесь все элементы просто складываются, и возвращается итоговый результат выражения. Пример: `[+2 +12 -4] -> 10`

Если же в нашем исходном выражении были скобки, то они из слайса вычленяются, берутся как отдельное выражение и пропускаются через `Calc(expression string) (float64, error)`. По сути, это рекурсия. 

В итоге, на место скобки ставится её результат. Знак перед скобкой сохраняется.

Пример: `[+2 +3 *(4+(5+6)] -> [+2 +3 *(4+11)] -> [+2 +3 *15]`